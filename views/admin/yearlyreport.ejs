

<%- include('../layouts/adminheader.ejs') -%>


<div class="container">
    <div class="row">
        
<div>
    <a class="btn btn-secondary ml-3 mt-3" href="/admin/yearlyreport/download">Download xlsx</a>
    <button class="btn btn-success ml-3 mt-3" onclick="printPage()">Print</button>
    </div>
    <div>
    
    
    </div>
    <div class="container mt-3">
    
        <table class="table">
            <thead>
                <tr>
    
                    <th scope="col">Total Order</th>
                    <th scope="col"></th>
                    <th scope="col">Total Revenue</th>
                </tr>
            </thead>
            <tbody>
                <tr>
    
                    <td><%= yearlyorders.length %></td>
                    <td></td>
                    <td><%= totalYearlyBill %></td>
                </tr>
    
            </tbody>
        </table>
    
    
        <table class="table">
            <thead class="thead-dark">
    
                <tr>
                    <th scope="col">ORDER ID</th>
    
    
                    <th scope="col">ORDER DATE</th>
                    
                    <th scope="col">TOTAL BILL</th>
    
                </tr>
    
            </thead>
    
            <tbody>
                <%
                if(yearlyorders)
                {

                for(let i=0;i<yearlyorders.length;++i)
                {

                %>
                <tr>
                    <% const dateString = yearlyorders[i].date 
                                      
                const date = new Date(dateString)
                const day = date.getDate().toString().padStart(2, '0')
                const month = (date.getMonth() + 1).toString().padStart(2, '0')
                const year = date.getFullYear()
                const formattedDate = `${day}-${month}-${year}`
                %>

    
                    <td><%= yearlyorders[i]._id %></td>
    
                    <td> <%= formattedDate %></td>
                    
                    <td><%= yearlyorders[i].amount %></td>
    
    
                </tr>
                <%
                 }

                }
                %>
    
    
            </tbody>
    
    
        </table>
    </div>
    </div>
    
    
    </div>
</div>

<script>
    function printPage() {
  window.print();
}

</script>


<%- include('../layouts/footer.ejs') -%>
